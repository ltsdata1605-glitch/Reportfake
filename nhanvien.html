<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hiệu Quả Nhân Viên - Analytics</title>
    <!-- Tích hợp Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome cho icon -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="nhanvien.css">
</head>
<body class="bg-gray-50 px-4 sm:px-6 lg:px-8">

    <!-- Main Navigation -->
    <nav class="bg-white dark:bg-slate-800 shadow-md sticky top-0 z-40 mb-4">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-center h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <a href="index.html" class="flex items-center gap-2 text-indigo-600 dark:text-indigo-400">
                            <i data-lucide="bar-chart-3" class="w-7 h-7"></i>
                            <span class="font-bold text-lg">Analytics</span>
                        </a>
                    </div>
                    <div class="hidden md:block">
                        <div class="ml-10 flex items-baseline space-x-4">
                            <a href="index.html" class="text-slate-500 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 hover:text-slate-800 dark:hover:text-white px-3 py-2 rounded-md text-sm font-medium">Dashboard</a>
                            <a href="nhanvien.html" class="bg-indigo-600 text-white px-3 py-2 rounded-md text-sm font-medium" aria-current="page">Nhân Viên</a>
                            <a href="#" class="text-slate-500 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 hover:text-slate-800 dark:hover:text-white px-3 py-2 rounded-md text-sm font-medium">Check Thi Đua</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="bg-white p-4 sm:p-6 rounded-2xl shadow-xl w-full max-w-7xl my-4 mx-auto">
        <!-- Tiêu đề -->
        <div class="flex justify-center items-center gap-2 mb-2">
            <h1 class="text-2xl md:text-3xl font-extrabold text-center text-gray-800">HIỆU QUẢ NHÂN VIÊN</h1>
            <span id="version-badge" class="bg-gray-200 text-gray-600 text-xs font-semibold px-2.5 py-0.5 rounded-full cursor-pointer hover:bg-gray-300 transition">v6.5</span>
        </div>
        <p class="text-center text-gray-500 mb-6">Dán văn bản vào ô bên dưới để tự động tạo bảng xếp hạng.</p>

        <!-- Khu vực nhập liệu (Giao diện Tab mới) -->
        <div class="mb-6 p-4 bg-gray-50 rounded-lg">
            <!-- Tab buttons -->
            <div class="border-b border-gray-200">
                <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                    <button class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-blue-500 text-blue-600" data-tab="doanhthu">Doanh Thu</button>
                    <button class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="thidua">Thi Đua</button>
                    <button class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-tab="tragop">Trả Góp</button>
                </nav>
            </div>

            <!-- Tab content -->
            <div class="mt-4">
                <!-- Panel 1: Doanh thu -->
                <div id="tab-panel-doanhthu" class="tab-panel">
                    <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-4 gap-4">
                        <h2 class="text-xl font-bold text-gray-800">Doanh Thu</h2>
                        <div class="flex items-center space-x-2">
                            <a href="https://bi.thegioididong.com/khoi-ban-hang-sub/-1" target="_blank" class="bg-blue-500 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-blue-600 transition flex items-center justify-center text-sm">
                                <i class="fas fa-download mr-2"></i> Tải dữ liệu
                            </a>
                             <button class="paste-btn bg-yellow-500 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-yellow-600 transition flex items-center justify-center text-sm" data-target-textarea="text-input-doanhthu">
                                <i class="fas fa-paste mr-2"></i> Dán
                            </button>
                            <button class="clear-btn bg-red-500 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-red-600 transition flex items-center justify-center text-sm" data-target-textarea="text-input-doanhthu">
                                <i class="fas fa-trash-alt mr-2"></i> Xoá
                            </button>
                        </div>
                    </div>
                    <textarea id="text-input-doanhthu" rows="4" 
                        placeholder="B1: Mở trang báo cáo (nút Tải dữ liệu)&#10;B2: Chọn siêu thị&#10;B3: BC Doanh thu theo nhân viên > Show dữ liệu từng bộ phận&#10;B4: Ctrl + A và Ctrl + C => Ctrl + V vào ô này" 
                        class="data-textarea w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-shadow"></textarea>
                </div>

                <!-- Panel 2: Thi đua -->
                <div id="tab-panel-thidua" class="tab-panel hidden">
                    <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-4 gap-4">
                        <h2 class="text-xl font-bold text-gray-800">Báo cáo Thi đua</h2>
                        <div class="flex items-center space-x-2">
                            <a href="https://bi.thegioididong.com/khoi-ban-hang-sub/-1" target="_blank" class="bg-blue-500 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-blue-600 transition flex items-center justify-center text-sm">
                                <i class="fas fa-download mr-2"></i> Tải dữ liệu
                            </a>
                            <button class="paste-btn bg-yellow-500 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-yellow-600 transition flex items-center justify-center text-sm" data-target-textarea="text-input-thidua">
                                <i class="fas fa-paste mr-2"></i> Dán
                            </button>
                            <button class="clear-btn bg-red-500 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-red-600 transition flex items-center justify-center text-sm" data-target-textarea="text-input-thidua">
                                <i class="fas fa-trash-alt mr-2"></i> Xoá
                            </button>
                        </div>
                    </div>
                    <textarea id="text-input-thidua" rows="4" placeholder="B1: Mở trang báo cáo (nút Tải dữ liệu) > Chọn siêu thị&#10;B2: BC Doanh thu theo nhân viên > Chương trình thi đua > Show dữ liệu từng bộ phận&#10;B3: Ctrl + A và Ctrl + C => Ctrl + V vào ô này" 
                        class="data-textarea w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-shadow"></textarea>
                </div>

                <!-- Panel 3: Trả góp -->
                <div id="tab-panel-tragop" class="tab-panel hidden">
                    <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-4 gap-4">
                        <h2 class="text-xl font-bold text-gray-800">Báo cáo Trả góp</h2>
                         <div class="flex items-center space-x-2">
                            <a href="https://bi.thegioididong.com/sieu-thi-con?id=16041&tab=bctg&rt=2&dm=1" target="_blank" class="bg-blue-500 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-blue-600 transition flex items-center justify-center text-sm">
                                <i class="fas fa-download mr-2"></i> Tải dữ liệu
                            </a>
                             <button class="paste-btn bg-yellow-500 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-yellow-600 transition flex items-center justify-center text-sm" data-target-textarea="text-input-tragop">
                                <i class="fas fa-paste mr-2"></i> Dán
                            </button>
                            <button class="clear-btn bg-red-500 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-red-600 transition flex items-center justify-center text-sm" data-target-textarea="text-input-tragop">
                                <i class="fas fa-trash-alt mr-2"></i> Xoá
                            </button>
                        </div>
                    </div>
                    <textarea id="text-input-tragop" rows="4" placeholder="Dán nội dung báo cáo Trả góp vào đây..." 
                        class="data-textarea w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-shadow"></textarea>
                </div>
            </div>
        </div>
        
        <!-- Bảng điều khiển Doanh Thu -->
        <div id="control-panel-doanhthu" class="mb-6 p-4 border border-gray-200 rounded-lg">
             <h2 class="text-xl font-bold text-gray-800 mb-4">Bảng điều khiển</h2>
             <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
                <!-- Cột Lọc -->
                <div>
                    <label for="department-filter-btn" class="block text-base font-semibold text-gray-700 mb-2">1. Lọc theo bộ phận</label>
                    <div id="custom-select-container" class="relative">
                        <button id="department-filter-btn" type="button" class="flex w-full items-center justify-between rounded-lg border border-gray-300 bg-white px-4 py-2 text-left text-sm shadow-sm transition hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <span id="selected-departments-text" class="text-gray-500">Chọn một hoặc nhiều bộ phận</span>
                            <i class="fas fa-chevron-down text-gray-400"></i>
                        </button>
                        <div id="department-filter-panel" class="absolute z-10 mt-1 hidden w-full rounded-md bg-white shadow-lg border border-gray-200">
                            <div class="p-2">
                                <input type="text" id="department-search" placeholder="Tìm kiếm bộ phận..." class="w-full rounded-md border-gray-300 px-3 py-2 text-sm shadow-sm focus:border-blue-500 focus:ring-blue-500">
                            </div>
                            <ul id="department-options-list" class="max-h-60 overflow-auto p-2">
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Cột Sắp xếp & Hành động -->
                <div>
                    <label class="block text-base font-semibold text-gray-700 mb-2">2. Sắp xếp & Hành động</label>
                    <div id="sort-controls" class="flex flex-wrap items-center gap-2">
                        <button data-key="DTQĐ" class="sort-btn flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-sm hover:bg-blue-600 transition text-sm">DTQĐ <i class="fas fa-arrow-down ml-1"></i></button>
                        <button data-key="DTLK" class="sort-btn flex-1 bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition text-sm">DTLK</button>
                        <button data-key="Hiệu quả QĐ" class="sort-btn flex-1 bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition text-sm">HQQĐ</button>
                        <button id="export-doanhthu-btn" title="Xuất ảnh" class="bg-green-500 text-white w-10 h-10 rounded-lg shadow-sm hover:bg-green-600 transition text-sm flex items-center justify-center">
                            <i class="fas fa-camera"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bảng điều khiển Thi Đua (MỚI) -->
        <div id="control-panel-thidua" class="mb-6 p-4 border border-gray-200 rounded-lg hidden">
            <h2 class="text-xl font-bold text-gray-800 mb-4">Bảng điều khiển Thi Đua</h2>
            <div class="space-y-6">
                <!-- Lọc theo Bộ Phận -->
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <label class="block text-base font-semibold text-gray-700">1. Lọc theo bộ phận</label>
                        <div class="space-x-2">
                            <button id="thidua-dept-select-all" class="text-xs font-semibold text-blue-500 hover:underline">Chọn tất cả</button>
                            <button id="thidua-dept-deselect-all" class="text-xs font-semibold text-gray-500 hover:underline">Bỏ chọn tất cả</button>
                        </div>
                    </div>
                    <div id="thidua-department-filter-container" class="flex flex-wrap gap-2 p-3 rounded-md border bg-gray-50">
                         <p class="text-gray-400 text-sm">Chưa có dữ liệu để lọc...</p>
                    </div>
                </div>

                <!-- Lọc theo Nhóm Hàng -->
                <div>
                    <div class="flex justify-between items-center mb-2">
                        <label class="block text-base font-semibold text-gray-700">2. Lọc theo nhóm thi đua</label>
                        <div class="space-x-2">
                            <button id="thidua-group-select-all" class="text-xs font-semibold text-blue-500 hover:underline">Chọn tất cả</button>
                            <button id="thidua-group-deselect-all" class="text-xs font-semibold text-gray-500 hover:underline">Bỏ chọn tất cả</button>
                        </div>
                    </div>
                    <div id="thidua-group-filter-container" class="flex flex-wrap gap-2 p-3 rounded-md border bg-gray-50">
                         <p class="text-gray-400 text-sm">Chưa có dữ liệu để lọc...</p>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
                    <!-- Lọc theo Tiêu chí (Tab) -->
                    <div>
                         <label class="block text-base font-semibold text-gray-700 mb-2">3. Lọc theo tiêu chí</label>
                        <div class="border-b border-gray-200">
                            <nav class="-mb-px flex space-x-8" id="thidua-criteria-tabs">
                                <button data-criteria-type="All" class="criteria-tab-btn whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm">All</button>
                                <button data-criteria-type="SLLK" class="criteria-tab-btn whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm">SLLK</button>
                                <button data-criteria-type="DTQĐ" class="criteria-tab-btn whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm">DTQĐ</button>
                                <button data-criteria-type="DTLK" class="criteria-tab-btn whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm">DTLK</button>
                            </nav>
                        </div>
                    </div>

                     <!-- Xuất ảnh & Reset -->
                     <div>
                        <label class="block text-base font-semibold text-gray-700 mb-2">4. Hành động</label>
                        <div class="flex gap-2">
                             <button id="thidua-reset-cols-btn" title="Đặt lại cột" class="flex-1 bg-gray-500 text-white py-3 rounded-lg shadow-sm hover:bg-gray-600 transition text-lg flex items-center justify-center">
                                <i class="fas fa-undo"></i>
                            </button>
                            <button id="export-thidua-btn" title="Xuất ảnh" class="flex-1 bg-green-500 text-white py-3 rounded-lg shadow-sm hover:bg-green-600 transition text-lg flex items-center justify-center">
                                <i class="fas fa-camera"></i>
                            </button>
                            <button id="export-all-thidua-btn" title="Xuất tất cả tiêu chí" class="flex-1 bg-purple-500 text-white py-3 rounded-lg shadow-sm hover:bg-purple-600 transition text-lg flex items-center justify-center">
                                <i class="fas fa-images"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Quản lý Nhóm Thi Đua / Phiên bản -->
                <div>
                    <label class="block text-base font-semibold text-gray-700">5. Quản lý phiên bản</label>
                    <div class="p-3 rounded-md border bg-gray-50 mt-2 space-y-3">
                        <div class="flex flex-col sm:flex-row gap-2">
                            <input type="text" id="thidua-view-name-input" placeholder="Tên phiên bản (vd: Nhóm SLLK)" class="flex-grow w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm">
                            <button id="thidua-save-view-btn" class="bg-blue-500 text-white px-4 py-2 rounded-md shadow-sm hover:bg-blue-600 transition flex items-center justify-center text-sm w-full sm:w-auto">
                                <i class="fas fa-save mr-2"></i>Lưu
                            </button>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-2">
                            <select id="thidua-saved-views-select" class="flex-grow w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 bg-white text-sm">
                                <option value="">-- Chọn phiên bản để tải --</option>
                            </select>
                            <button id="thidua-load-view-btn" class="bg-green-500 text-white px-4 py-2 rounded-md shadow-sm hover:bg-green-600 transition flex items-center justify-center text-sm w-full sm:w-auto mt-2 sm:mt-0">
                                <i class="fas fa-download mr-2"></i>Tải
                            </button>
                            <button id="thidua-delete-view-btn" class="bg-red-500 text-white px-4 py-2 rounded-md shadow-sm hover:bg-red-600 transition flex items-center justify-center text-sm w-full sm:w-auto mt-2 sm:mt-0">
                                <i class="fas fa-trash-alt mr-2"></i>Xoá
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vùng kết quả dạng bảng xếp hạng -->
        <div id="capture-area-wrapper">
            <!-- Panel kết quả Doanh thu -->
            <div id="results-panel-doanhthu" class="results-panel p-4 rounded-lg bg-white mx-auto">
                <div class="flex items-center text-center text-gray-400 mb-4">
                    <div class="flex-grow border-t border-gray-300"></div>
                    <h2 id="results-title-doanhthu" class="text-2xl font-bold text-gray-700 px-4 whitespace-nowrap">TOP BEST SELLER DOANH THU QĐ</h2>
                    <div class="flex-grow border-t border-gray-300"></div>
                </div>
                <div id="results-container-doanhthu" class="space-y-4"></div>
            </div>
             <!-- Panel kết quả Thi đua -->
            <div id="results-panel-thidua" class="results-panel hidden p-4 rounded-lg bg-white">
                <div class="flex items-center text-center text-gray-400 mb-4">
                    <div class="flex-grow border-t border-gray-300"></div>
                    <h2 id="results-title-thidua" class="text-2xl font-bold text-gray-700 px-4">HIỆU QUẢ THI ĐUA NGÀNH HÀNG</h2>
                    <div class="flex-grow border-t border-gray-300"></div>
                </div>
                <div id="results-container-thidua" class="space-y-4"></div>
            </div>
             <!-- Panel kết quả Trả góp -->
            <div id="results-panel-tragop" class="results-panel hidden p-4 rounded-lg bg-white">
                 <div class="flex items-center text-center text-gray-400 mb-4">
                    <div class="flex-grow border-t border-gray-300"></div>
                    <h2 class="text-2xl font-bold text-gray-700 px-4">TRẢ GÓP</h2>
                    <div class="flex-grow border-t border-gray-300"></div>
                </div>
                <div id="results-container-tragop" class="space-y-4"></div>
            </div>
        </div>
        
        <!-- Debug Output -->
        <div id="debug-output-container" class="hidden mt-6">
            <h3 class="text-xl font-bold text-gray-800 mb-2">Thông tin gỡ lỗi (Debug)</h3>
            <pre id="debug-output" class="bg-gray-900 text-white text-xs p-4 rounded-lg overflow-x-auto h-64"></pre>
            <div class="flex items-center mt-4">
                <input type="checkbox" id="debug-checkbox" class="h-4 w-4 rounded border-gray-300 text-yellow-600 focus:ring-yellow-500">
                <label for="debug-checkbox" class="ml-2 text-sm font-medium text-gray-700">Hiển thị thông tin gỡ lỗi</label>
            </div>
        </div>
    </div>
    
    <!-- Thông báo Toast -->
    <div id="toast-notification" class="fixed top-5 right-5 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg transform translate-x-full hidden z-50">
        <!-- Nội dung thông báo -->
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-[9999] flex items-center justify-center transition-opacity duration-300">
        <div class="text-white text-center p-8 bg-gray-800 rounded-lg shadow-xl">
            <i class="fas fa-spinner fa-spin text-4xl text-blue-400"></i>
            <p class="mt-4 text-lg font-semibold">Đang xuất ảnh, vui lòng chờ...</p>
        </div>
    </div>

    <!-- Changelog Modal -->
    <div id="changelog-modal" class="hidden fixed inset-0 bg-black bg-opacity-60 z-[9998] flex items-center justify-center transition-opacity duration-300 p-4">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] overflow-y-auto">
            <div class="sticky top-0 bg-gray-100 p-4 border-b flex justify-between items-center">
                <h3 class="text-xl font-bold text-gray-800">Lịch sử Phiên bản</h3>
                <button id="close-changelog-modal" class="text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
            </div>
            <div class="p-6 space-y-6">
                <!-- Version 6.2 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v6.2</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Sửa lỗi nghiêm trọng:</b> Vá lỗi `TypeError` khi sử dụng chức năng 'Xuất All' và khắc phục sự cố dán dữ liệu từ clipboard.</li>
                    </ul>
                </div>
                <!-- Version 6.1 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v6.1</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Sửa lỗi nghiêm trọng:</b> Vá lỗi `TypeError` gây treo ứng dụng khi xử lý dữ liệu Thi đua.</li>
                        <li><b>Hoàn nguyên giao diện:</b> Loại bỏ các chế độ xem "Theo nhân viên" / "Theo nhóm" và khôi phục lại tab "All" để đơn giản hóa giao diện.</li>
                    </ul>
                </div>
                <!-- Version 6.0 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v6.0</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Tái cấu trúc bộ lọc Thi đua:</b> Loại bỏ nút chuyển đổi "Theo nhân viên"/"Theo nhóm", tích hợp chức năng vào thanh tab "Lọc theo tiêu chí" với các tab mới: "Nhân viên" và "Nhóm".</li>
                        <li><b>Cải tiến chức năng "Xuất All":</b> Nút "Xuất All" sẽ chỉ hiển thị ở chế độ xem theo nhân viên.</li>
                    </ul>
                </div>
                 <!-- Version 5.9 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v5.9</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Kích hoạt lại nút "Dán":</b> Sửa lỗi và kích hoạt lại chức năng dán dữ liệu từ clipboard.</li>
                    </ul>
                </div>
                 <!-- Version 5.8 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v5.8</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Chế độ xem mới:</b> Bổ sung chế độ xem "Theo Nhóm" để phân tích hiệu quả theo từng nhóm thi đua.</li>
                        <li><b>Nút "Xuất All":</b> Thêm nút mới cho phép xuất đồng thời 3 ảnh báo cáo cho 3 tiêu chí (SLLK, DTQĐ, DTLK).</li>
                        <li><b>Cải tiến giao diện:</b> Tab "All" được đổi tên thành "Nhân viên" và đặt làm mặc định.</li>
                    </ul>
                </div>
                <!-- Version 5.6 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v5.6</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Sửa lỗi hiển thị:</b> Cột "Hiệu quả" giờ đây sẽ được cố định đúng vị trí khi cuộn ngang.</li>
                        <li><b>Xoá dữ liệu mẫu:</b> Dữ liệu mẫu trong tab "Doanh thu" đã được xoá.</li>
                    </ul>
                </div>
                <!-- Version 5.4 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v5.4</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Thay đổi logic cảnh báo:</b> Cảnh báo 30% nhân viên có hiệu quả thấp nhất trong mỗi bộ phận, thay vì dựa trên tỷ lệ tiêu chí không đạt.</li>
                    </ul>
                </div>
                <!-- Version 5.3 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v5.3</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Thêm tab "All":</b> Bổ sung tab "All" trong bộ lọc tiêu chí để hiển thị tất cả nhóm thi đua, được sắp xếp theo từng loại tiêu chí (SLLK, DTQĐ, DTLK).</li>
                        <li><b>Điều chỉnh ngưỡng cảnh báo:</b> Cảnh báo hiệu quả thấp giờ sẽ hiển thị cho nhân viên có <b>>=70%</b> (thay vì 30%) nhóm thi đua không đạt hiệu quả trung bình.</li>
                        <li><b>Xoá dữ liệu mẫu:</b> Dữ liệu mẫu trong các ô nhập liệu của tab "Thi Đua" và "Trả Góp" đã được xoá để giao diện sạch sẽ hơn khi bắt đầu.</li>
                    </ul>
                </div>
                 <!-- Version 5.2 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v5.2</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Điều chỉnh ngưỡng cảnh báo:</b> Cảnh báo hiệu quả thấp giờ sẽ hiển thị cho nhân viên có <b>>=30%</b> (thay vì 50%) nhóm thi đua không đạt hiệu quả trung bình.</li>
                    </ul>
                </div>
                 <!-- Version 5.1 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v5.1</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Sắp xếp mặc định:</b> Bảng Thi đua giờ đây sẽ tự động sắp xếp theo cột "Hiệu Quả" (giảm dần) khi tải.</li>
                        <li><b>Thêm TOP 1,2,3:</b> Biểu tượng huy chương vàng, bạc, đồng sẽ hiển thị cho 3 nhân viên có hiệu quả cao nhất trong mỗi bộ phận.</li>
                        <li><b>Cảnh báo hiệu quả:</b> Biểu tượng cảnh báo cho nhân viên hiệu quả thấp đã được đổi thành màu đỏ cho dễ nhận biết hơn.</li>
                    </ul>
                </div>
                <!-- Version 5.0 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v5.0</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                         <li><b>Cảnh báo hiệu quả thấp:</b> Thêm biểu tượng cảnh báo <i class="fas fa-exclamation-triangle text-yellow-500"></i> cho nhân viên có từ 50% nhóm thi đua không đạt hiệu quả trung bình.</li>
                    </ul>
                </div>
                <!-- Version 4.9 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v4.9</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                         <li><b>Thêm cột Hiệu Quả:</b> Bổ sung cột "Hiệu Quả" trong bảng Thi Đua, hiển thị dưới dạng X/Y (số nhóm đạt / tổng số nhóm) và cho phép sắp xếp.</li>
                    </ul>
                </div>
                <!-- Version 4.8 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v4.8</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                         <li><b>Cập nhật Rút gọn tiêu đề:</b> Cập nhật và bổ sung thêm các quy tắc rút gọn mới cho tên nhóm thi đua.</li>
                    </ul>
                </div>
                <!-- Version 4.7 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v4.7</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                         <li><b>Thêm Rút gọn tiêu đề:</b> Bổ sung "Thi đua Iphone 17 series" vào danh sách rút gọn thành "iPhone 17".</li>
                    </ul>
                </div>
                <!-- Version 4.6 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v4.6</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                         <li><b>Rút gọn tiêu đề:</b> Tự động rút gọn tên các nhóm thi đua theo danh sách gợi ý để giao diện bảng gọn gàng hơn.</li>
                    </ul>
                </div>
                 <!-- Version 4.5 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v4.5</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Tối ưu bảng Thi Đua:</b></li>
                        <li class="ml-4">- Căn chỉnh lại nội dung trong các ô để không bị lệch dòng khi xuất ảnh.</li>
                        <li class="ml-4">- Tiêu đề các nhóm thi đua dài được tự động rút gọn.</li>
                        <li class="ml-4">- Độ rộng các cột được điều chỉnh để cân đối và chuyên nghiệp hơn.</li>
                        <li class="ml-4">- Thay đổi tiêu đề cột "Nhóm TĐ" thành "Nhân Viên" cho rõ ràng.</li>
                    </ul>
                </div>
                <!-- Version 4.4 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v4.4</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Bố cục cột Thi Đua:</b> Các cột dữ liệu có độ rộng bằng nhau và hẹp hơn, tiêu đề "Nhóm thi đua" được rút gọn. Cải thiện căn chỉnh dọc để nội dung luôn ở giữa ô.</li>
                    </ul>
                </div>
                 <!-- Version 4.3 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v4.3</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Căn chỉnh và bố cục bảng Thi Đua:</b></li>
                        <li class="ml-4">- Các cột dữ liệu giờ đây có độ rộng bằng nhau và tự động điều chỉnh theo nội dung.</li>
                        <li class="ml-4">- Tiêu đề dài tự động xuống dòng để phù hợp với cột hẹp hơn.</li>
                        <li class="ml-4">- Sửa lỗi nội dung bị lệch xuống dưới khi xuất ảnh.</li>
                    </ul>
                </div>
                 <!-- Version 4.2 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v4.2</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Tối ưu hiển thị:</b> Các cột trong bảng Thi Đua được thu hẹp lại.</li>
                        <li><b>Xuống dòng tự động:</b> Tiêu đề dài trong bảng Thi Đua sẽ tự động xuống dòng để dễ đọc hơn.</li>
                    </ul>
                </div>
                 <!-- Version 4.1 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v4.1</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Sửa lỗi nghiêm trọng:</b> Vá lỗi `TypeError` và `SyntaxError` gây treo ứng dụng trong một số trường hợp.</li>
                    </ul>
                </div>
                 <!-- Version 4.0 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v4.0</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Tinh chỉnh giao diện:</b> Căn chỉnh lại nội dung trong bảng Thi Đua để đảm bảo vị trí luôn ở chính giữa ô khi xuất ảnh.</li>
                        <li><b>Thu gọn cột:</b> Giảm độ rộng các cột dữ liệu trong bảng Thi Đua để giao diện gọn gàng và dễ nhìn hơn.</li>
                    </ul>
                </div>
                 <!-- Version 3.9 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v3.9</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Căn chỉnh hoàn hảo:</b> Sửa lỗi căn chỉnh cuối cùng trong bảng Thi Đua. Giờ đây, mọi nội dung (văn bản và biểu tượng) sẽ được căn giữa ô một cách hoàn hảo, giống như hình ảnh mẫu người dùng cung cấp.</li>
                    </ul>
                </div>
                 <!-- Version 3.8 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v3.8</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Sửa lỗi Sắp xếp Cột:</b> Vá lỗi nghiêm trọng khiến tính năng "Sắp xếp cột theo bộ lọc" không hoạt động. Giờ đây các cột sẽ hiển thị chính xác theo thứ tự lựa chọn.</li>
                    </ul>
                </div>
                 <!-- Version 3.7 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v3.7</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Căn chỉnh bảng:</b> Căn giữa nội dung trong các ô của bảng Thi Đua để bản xuất ảnh trông chuyên nghiệp, không bị lệch dòng.</li>
                        <li><b>Tối ưu xuất ảnh:</b> Cải thiện chất lượng hình ảnh xuất ra và đảm bảo chụp toàn bộ nội dung bảng, kể cả khi có thanh cuộn.</li>
                    </ul>
                </div>
                 <!-- Version 3.6 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v3.6</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Sắp xếp cột theo bộ lọc:</b> Cột trong bảng Thi đua giờ sẽ hiển thị theo đúng thứ tự người dùng chọn trong bộ lọc "Nhóm thi đua".</li>
                        <li><b>Lưu trữ phiên bản bền vững:</b> Cải thiện tính năng "Quản lý phiên bản" để đảm bảo dữ liệu đã lưu không bị mất khi làm mới hoặc đóng trình duyệt. Thêm thông báo lỗi nếu trình duyệt không cho phép lưu trữ.</li>
                    </ul>
                </div>
                 <!-- Version 3.5 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v3.5</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Quản lý phiên bản:</b> Thêm chức năng lưu, tải và xoá các phiên bản báo cáo (thứ tự cột, bộ lọc) trong tab Thi Đua.</li>
                        <li><b>Cải tiến giao diện:</b> Giảm độ rộng các cột dữ liệu trong bảng Thi Đua để giao diện gọn gàng hơn.</li>
                    </ul>
                </div>
                 <!-- Version 3.4 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v3.4</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Cố định ô "Tiêu chí":</b> Ô "Tiêu chí" trong bảng Thi Đua giờ đã được cố định khi cuộn ngang.</li>
                        <li><b>Kích hoạt lại Sắp xếp:</b> Sửa lỗi và kích hoạt lại tính năng sắp xếp bằng cách nhấp vào tiêu đề cột trong bảng Thi Đua.</li>
                        <li><b>Cân đối cột:</b> Độ rộng các cột dữ liệu trong bảng Thi Đua được cố định bằng nhau để giao diện cân đối hơn.</li>
                    </ul>
                </div>
                 <!-- Version 3.3 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v3.3</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li><b>Sửa lỗi & Nâng cấp bộ lọc Thi Đua:</b> Sửa lỗi bộ lọc "Nhóm thi đua" và "Tiêu chí" không hoạt động.</li>
                        <li><b>Quản lý cột Thi Đua:</b> Bổ sung tính năng kéo-thả để sắp xếp và nút (x) để xóa cột nhóm thi đua.</li>
                        <li><b>Giao diện chuyên nghiệp:</b> Thiết kế lại bảng kết quả Thi Đua, làm nổi bật dòng tiêu đề và cố định cột nhân viên.</li>
                         <li><b>Cảnh báo hiệu suất:</b> Thay đổi cảnh báo từ tô nền sang chỉ đổi màu chữ cho các nhân viên có kết quả dưới trung bình.</li>
                    </ul>
                </div>
                 <!-- Version 3.2 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v3.2</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li>
                            <b>Bảng Thi Đua:</b> Tự động làm nổi bật nhân viên có thành tích cao nhất (TOP) và thấp nhất (BOT) trong mỗi bộ phận theo từng tiêu chí.
                        </li>
                    </ul>
                </div>
                 <!-- Version 3.1 -->
                 <div>
                    <h4 class="text-lg font-semibold text-gray-700">v3.1</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li>
                            <b>Cải tiến hiển thị bảng Doanh Thu:</b>
                            <ul class="list-['-_'] list-inside ml-4">
                                <li>Thêm thanh tiến trình (progress bar) để so sánh hiệu quả.</li>
                                <li>Tô sáng hàng khi di chuột vào nhân viên.</li>
                                <li>Xếp hạng nhân viên được tính lại trong từng bộ phận.</li>
                                <li>Giảm khoảng cách giữa các thẻ nhân viên cho giao diện gọn hơn.</li>
                            </ul>
                        </li>
                         <li>
                            <b>Cải tiến hiển thị bảng Thi Đua & Trả Góp:</b>
                             <ul class="list-['-_'] list-inside ml-4">
                                <li>Cố định cột đầu tiên (tên nhân viên) khi cuộn ngang.</li>
                                <li>Bỏ tooltip không cần thiết để giao diện gọn hơn.</li>
                            </ul>
                        </li>
                        <li><b>Cải tiến chung:</b>
                            <ul class="list-['-_'] list-inside ml-4">
                                 <li>Tự động điều chỉnh độ rộng bảng kết quả để vừa với nội dung, tránh khoảng trống.</li>
                                 <li>Thêm hiệu ứng đóng khung cho tiêu đề bảng kết quả.</li>
                            </ul>
                        </li>
                    </ul>
                </div>
                <!-- Version 3.0 -->
                <div>
                    <h4 class="text-lg font-semibold text-gray-700">v3.0</h4>
                    <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1">
                        <li>Thêm tính năng xem lịch sử phiên bản khi nhấn vào tag version.</li>
                        <li>Cập nhật phiên bản lên v3.0.</li>
                        <li>Thay đổi văn bản giao diện: "Bảng Xếp Hạng Nhân Viên" -> "HIỆU QUẢ NHÂN VIÊN", và các tên tab.</li>
                        <li>Điều chỉnh layout "Bảng điều khiển Thi Đua" và vị trí nút "Xuất ảnh".</li>
                        <li>Cải tiến chức năng xuất ảnh: căn giữa tiêu đề kết quả và đảm bảo chụp toàn bộ chiều rộng của bảng.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>


    <!-- Thư viện JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    
    <!-- Custom JS -->
    <script src="nhanvien.js" defer></script>
</body>
</html>